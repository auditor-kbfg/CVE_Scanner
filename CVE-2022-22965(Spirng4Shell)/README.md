ENG

The script is designed for primary filtering when conducting bulk URL checks for the Spring4Shell vulnerability.

This script is based on the p1ckzi/CVE-2022-22965 GitHub repository, with the following modifications:

Removal of Webshell script (Webshell is not suitable for large-scale URL operations, hence removed)
Only verifies access to Tomcat logs (necessary to prevent false positives due to frequent Webshell attempts)
False Positives:
Running this script may appear to succeed, but actual failure to insert a Webshell is common for the following reasons:
It only checks access to logs on the WAS server (fails if not Tomcat).
It indicates regardless of the use of the Spring Framework (fails if not Spring4Shell).
Reasons for Script Usage:
It is recommended to use this script solely for primary filtering purposes when checking multiple URLs, including SubDomains.

For URLs deemed risky after the primary filtering, it is crucial to attempt Webshell insertion to verify actual issues (refer to the Origin folder).

Usage:

Run python Scanner.py URL.txt
Result Verification:
If "www.test.com Injection Success Check PLZ" appears, attempt Webshell insertion attack.

Caution:
Scanner.py and spring4shell.py must be in the same location.
Reference GITHUB : https://github.com/p1ckzi/CVE-2022-22965

KOR

위 스크립트는 Spring4Shell 대량의 URL 점검 시 1차적인 필터링을 위해서 제작한 스크립트입니다.

해당 스크립트는 p1ckzi/CVE-2022-22965 GitHub을 베이스로 만들었으며 
다음 스크립트의 수정이 있습니다.
- Webshell 스크립트 제거 (대용량 URL 작업에 Webshell이 적합하지 않아 제거)
- Tomcat Log 접근여부만 확인(오탐이 많으므로 Webshell시도 필수)

* 오탐
해당 스크립트를 돌리면 성공하는것처럼 보이지만 실제로 Webshell 넣는 것에 실패하는 경우 多
그 이유로는 다음과 같습니다.
1. WAS서버에 로그 접근여부만 확인합니다. (Tomcat 아닐경우 실패)
2. SpringFramework 사용여부랑 별개로 표시합니다(Spring4Shell로 Spring아닐경우 실패)

스크립트 사용이유
SubDomain을 포함한 다수의 URL을 점검할 시 1차적인 필터링 용도로만 사용하길 권장합니다.

점검결과 1차 필터링에서 위험하다고 판단된 URL에 대한 실제 문제 여부는 꼭 Webshell삽입까지 시도해보세요
(Origin 폴더 참고)

사용방법
1.python Scanner.py URL.txt

결과 확인방법:
www.test.com Injection Success Check PLZ가 나올 시 Webshell 삽입 공격 시도

주의:
Scanner.py와 spring4shell.py는 같은 위치에 있어야합니다.

참고 GITHUB : https://github.com/p1ckzi/CVE-2022-22965